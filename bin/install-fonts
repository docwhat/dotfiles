#!/bin/zsh

set -euo pipefail

cd "$(dirname "$0")"

typeset -r v='v0.9.0'
typeset -a urls
typeset update
update=f

urls+=(
"https://raw.githubusercontent.com/ryanoasis/nerd-fonts/${v}/patched-fonts/FiraCode/Retina/complete/Fura%20Code%20Retina%20Nerd%20Font%20Complete.otf"

"https://raw.githubusercontent.com/ryanoasis/nerd-fonts/${v}/patched-fonts/Hack/Regular/complete/Knack%20Regular%20Nerd%20Font%20Complete.ttf"

"https://raw.githubusercontent.com/ryanoasis/nerd-fonts/${v}/patched-fonts/FantasqueSansMono/Regular/complete/Fantasque%20Sans%20Mono%20Regular%20Nerd%20Font%20Complete.ttf"
)

fetch_font() {
  local url fname fontpath
  url=$1
  fname=$(uridecode "$(basename "$url")")
  fontpath=~/Library/Fonts/"$fname"
  echo "Fetching '${fname}'..."
  if [ ! -r "$fontpath" ]; then
    curl -L -o "$fontpath" "$url"
  elif [ "$update" = t ]; then
    curl -L -z "$fontpath" -o "$fontpath" "$url"
  fi
}

## Main
if [[ "${OSTYPE}" != darwin* ]]; then
  echo "${OSTYPE} is not supported\!" 1>&2
  exit 10
fi

for url in "${urls[@]}"; do
  fetch_font "$url"
done

# EOF
