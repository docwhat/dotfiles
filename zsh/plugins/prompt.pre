pretty_hostname() {
  local h

  if [ -n "$SHORT_HOST" ]; then
    h=$SHORT_HOST
  else
    h="%m"
  fi
  if [[ -n "$SSH_CLIENT" || -n "$SSH_TTY" ]]; then
    h="%{%F{yellow}%}${h}%{%f%}"
  fi
  echo "${(%)h}"
}

prompt_newline() {
  local lws
  [[ "$1" == "right" ]] && return
  lws=$POWERLEVEL9K_WHITESPACE_BETWEEN_LEFT_SEGMENTS
  POWERLEVEL9K_WHITESPACE_BETWEEN_LEFT_SEGMENTS=
  "$1_prompt_segment" \
    "$0" \
    "$2" \
    "NONE" "NONE" $'\n'
  POWERLEVEL9K_WHITESPACE_BETWEEN_LEFT_SEGMENTS=$lws
}

# general
POWERLEVEL9K_MODE='nerdfont-complete'

# Use the pretty_hostname so that we don't show the
# constantly changing hostname when using wifi.
POWERLEVEL9K_CONTEXT_TEMPLATE="%n@$(pretty_hostname)"

POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(
os_icon
context
dir
dir_writable
rbenv
# nvm # pending PR #516
vcs
docker_machine

newline

root_indicator
background_jobs
status
)

POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS=(
command_execution_time
time
newline
history
)

# command_execution_time
POWERLEVEL9K_COMMAND_EXECUTION_TIME_THRESHOLD=6
POWERLEVEL9K_COMMAND_EXECUTION_TIME_PRECISION=1

# nvm
POWERLEVEL9K_NVM_BACKGROUND=magenta
POWERLEVEL9K_NVM_FOREGROUND=black

# go_version
POWERLEVEL9K_GO_VERSION_BACKGROUND=magenta
POWERLEVEL9K_GO_VERSION_FOREGROUND=black

# dir
POWERLEVEL9K_SHORTEN_STRATEGY='truncate_with_package_name'
POWERLEVEL9K_SHORTEN_DELIMITER='â€¦'
POWERLEVEL9K_DIR_HOME_BACKGROUND=75
POWERLEVEL9K_DIR_HOME_FOREGROUND=16
POWERLEVEL9K_DIR_HOME_SUBFOLDER_BACKGROUND=75
POWERLEVEL9K_DIR_HOME_SUBFOLDER_FOREGROUND=16
POWERLEVEL9K_DIR_DEFAULT_BACKGROUND=75
POWERLEVEL9K_DIR_DEFAULT_FOREGROUND=16

# status
POWERLEVEL9K_STATUS_SHOW_PIPESTATUS=true # pending PR #515

# vcs
POWERLEVEL9K_CHANGESET_HASH_LENGTH=8
